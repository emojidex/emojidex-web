/*
 *  jQuery Emojidex - v0.1.0
 *  emojidex coffee plugin for jQuery/Zepto and compatible
 *  https://github.com/Genshin/emojidex-coffee#emojidex-coffee
 *
 *  Made by Genshin
 *  Under LGPL License
 */
(function(){!function(a){var b,c,d;return d="emojidex",c={emojiarea:{plaintext:"emojidex-plaintext",wysiwyg:"emojidex-wysiwyg",value_output:"emojidex-rawtext"}},b=function(){function b(b,e){this.element=b,this.options=a.extend({},c,e),this._defaults=c,this._name=d,this.loadEmojidexJSON(this.element,this.options),this.setEmojiarea(this.options)}return b.prototype.loadEmojidexJSON=function(c,d){return a.emojiarea.path=d.path_img,a.getJSON(d.path_json,function(e){var f;return e=b.prototype.getCategorizedData(e),a.emojiarea.icons=e,f=b.prototype.setEmojiCSS_getEmojiRegexps(e),b.prototype.setEmojiIcon(e,c,f),b.prototype.prepareAutoComplete(e,d)})},b.prototype.getCategorizedData=function(a){var b,c,d,e;for(c={},d=0,e=a.length;e>d;d++)b=a[d],null==c[b.category]?c[b.category]=[b]:c[b.category].push(b);return c},b.prototype.getEmojiDataFromAPI=function(){var a;return a="https://www.emojidex.com/api/v1/emoji/puni_pink"},b.prototype.setEmojiCSS_getEmojiRegexps=function(b){var c,d,e,f,g,h,i,j;h="",g=":(",e=a('<style type="text/css" />');for(c in b)for(f=b[c],i=0,j=f.length;j>i;i++)d=f[i],h+=d.moji+"|",g+=d.code+"|",e.append("i.emojidex-"+d.moji+" {background-image: url('"+a.emojiarea.path+d.code+".svg')}");return a("head").append(e),[h.slice(0,-1),g.slice(0,-1)+"):"]},b.prototype.setEmojiIcon=function(b,c,d){var e,f,g;return e=function(a){return'<i class="emojidex-'+a+'"></i>'},g=function(a,b){return a=a.replace(new RegExp(b,"g"),function(a){return e(a)})},f=function(a,b,c){return a=a.replace(new RegExp(b,"g"),function(a){var b,d,f,g,h;a=a.replace(/:/g,"");for(b in c)for(h=c[b],f=0,g=h.length;g>f;f++)if(d=h[f],d.code===a)return e(d.moji)})},a(c).find(":not(iframe,textarea,script)").andSelf().contents().filter(function(){return this.nodeType===Node.TEXT_NODE}).each(function(){var c;return c=this.textContent,c=g(c,d[0]),c=f(c,d[1],b),a(this).replaceWith(c)})},b.prototype.setEmojiarea=function(b){return b.emojiarea.plaintext.emojiarea({wysiwyg:!1}),b.emojiarea.wysiwyg.on("change",function(){return b.emojiarea.value_output.text(a(this).val())}),b.emojiarea.wysiwyg.trigger("change")},b.prototype.prepareAutoComplete=function(b,c){var d,e,f,g,h,i,j;g=[];for(d in b)for(j=b[d],h=0,i=j.length;i>h;h++)e=j[h],g.push(e.code);return g=a.map(g,function(a){return{key:a,name:a}}),f={at:":",data:g,tpl:"<li data-value=':${key}:'><img src='../src/assets/img/utf/${name}.svg'  height='20' width='20' /> ${name}</li>",insert_tpl:"<img src='../src/assets/img/utf/${name}.svg' height='20' width='20' />"},c.emojiarea.plaintext.atwho(f),c.emojiarea.wysiwyg.atwho(f)},b}(),a.fn[d]=function(c){return this.each(function(){return a.data(this,"plugin_"+d)?void 0:a.data(this,"plugin_"+d,new b(this,c))})}}(jQuery,window,document)}).call(this);