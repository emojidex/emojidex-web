/*
 *  jQuery Emojidex - v0.1.0
 *  emojidex coffee plugin for jQuery/Zepto and compatible
 *  https://github.com/Genshin/emojidex-coffee#emojidex-coffee
 *
 *  Made by Genshin
 *  Under LGPL License
 */
(function(){!function(a){var b,c,d;return d="emojidex",c={emojiarea:{plaintext:"emojidex-plaintext",wysiwyg:"emojidex-wysiwyg",value_output:"emojidex-rawtext"}},b=function(){function b(b,e){this.element=b,this.options=a.extend({},c,e),this._defaults=c,this._name=d,this.loadEmojidexJSON(this.element,this.options),this.setEmojiarea(this.options)}return b.prototype.loadEmojidexJSON=function(c,d){return a.emojiarea.path=d.path_img,a.getJSON(d.path_json,function(d){var e;return d=b.prototype.getCategorizedData(d),a.emojiarea.icons=d,e=b.prototype.setEmojiCSS_getEmojiRegexps(d),b.prototype.setEmojiIcon(d,c,e)})},b.prototype.getCategorizedData=function(a){var b,c,d,e,f,g,h,i,j,k;for(c=[],f=0,i=a.length;i>f;f++)d=a[f],c.indexOf(d.category)<0&&c.push(d.category);for(e={},g=0,j=c.length;j>g;g++)b=c[g],e[b]=[];for(h=0,k=a.length;k>h;h++)d=a[h],e[d.category].push(d);return e},b.prototype.setEmojiCSS_getEmojiRegexps=function(b){var c,d,e,f,g,h,i,j;h="",g=":(",e=a('<style type="text/css" />');for(c in b)for(f=b[c],i=0,j=f.length;j>i;i++)d=f[i],h+=d.moji+"|",g+=d.code+"|",e.append("i.emojidex-"+d.moji+" {background-image: url('"+a.emojiarea.path+d.code+".svg')}");return a("head").append(e),[h.slice(0,-1),g.slice(0,-1)+"):"]},b.prototype.setEmojiIcon=function(b,c,d){var e,f,g;return e=function(a){return'<i class="emojidex-'+a+'"></i>'},g=function(a,b){return a=a.replace(new RegExp(b,"g"),function(a){return e(a)})},f=function(a,b,c){return a=a.replace(new RegExp(b,"g"),function(a){var b,d,f,g,h;a=a.replace(/:/g,"");for(b in c)for(h=c[b],f=0,g=h.length;g>f;f++)if(d=h[f],d.code===a)return e(d.moji)})},a(c).find(":not(iframe,textarea,script)").andSelf().contents().filter(function(){return this.nodeType===Node.TEXT_NODE}).each(function(){var c;return c=this.textContent,c=g(c,d[0]),c=f(c,d[1],b),a(this).replaceWith(c)})},b.prototype.setEmojiarea=function(b){return b.emojiarea.plaintext.emojiarea({wysiwyg:!1}),b.emojiarea.wysiwyg.emojiarea({wysiwyg:!0}),b.emojiarea.wysiwyg.on("change",function(){return b.emojiarea.value_output.text(a(this).val())}),b.emojiarea.wysiwyg.trigger("change")},b}(),a.fn[d]=function(c){return this.each(function(){return a.data(this,"plugin_"+d)?void 0:a.data(this,"plugin_"+d,new b(this,c))})}}(jQuery,window,document)}).call(this);